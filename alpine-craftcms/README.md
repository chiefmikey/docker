# **Alpine CraftCMS**

Runs Apache 2 to serve a new CraftCMS installation with PHP 8 using PHP-FPM

_This image requires minimal configuration to launch and successfully render the
CraftCMS admin installation page_

[Available on Docker Hub](https://hub.docker.com/r/chiefmikey/alpine-craftcms)

## **Getting Started**

Run the container exposing `port 3000` where Apache is set to listen for
connections. Allow the startup script to install dependencies and set
permissions

A .env file is included in the `/craft` directory and includes

`APP_ID` and `SECURITY_KEY` are auto generated by CraftCMS on first startup but
can be updated with preexisting keys or regenerated with

```shell
php craft setup/app-id
php craft setup/security-key
```

Database configuration can be prepared in the .env file or it will be populated
as part of the final CraftCMS client installation

The `license.key` file located in the `/config` directory will be populated as
part of the final CraftCMS client installation as well

Navigate to the CraftCMS admin page (ex. http://localhost:3000/admin) and follow
the prompts until installation is complete

## Examples

```shell
docker run -d \
  --name alpine-craftcms \
  -v \
    .env:/craft/.env:ro \
    license.key:/craft/config/license.key:ro \
    composer.json:/craft/composer.json:ro \
  --env \
    ENVIRONMENT=dev \
    APP_ID=1 \
    SECURITY_KEY=1 \
    DB_DRIVER=pgsql \
    DB_SERVER=127.0.0.1 \
    DB_PORT=5432 \
    DB_DATABASE=db \
    DB_USER=user \
    DB_PASSWORD=password \
    DB_SCHEMA=public \
    DB_TABLE_PREFIX= \
    CP_TRIGGER=admin \
    PRIMARY_SITE_URL=http://127.0.0.1:3000 \
  -p 3000:3000 \
  chiefmikey/alpine-api:latest
```

```yaml
# docker-compose.yaml
services:
  api:
    container_name: alpine-craftcms
    image: chiefmikey/alpine-craftcms:latest
    volumes:
      - .env:/craft/.env:ro
      - license.key:/craft/config/license.key:ro
      - composer.json:/craft/composer.json:ro
    environment:
      - ENVIRONMENT=dev
      - APP_ID=1
      - SECURITY_KEY=1
      - DB_DRIVER=pgsql
      - DB_SERVER=127.0.0.1
      - DB_PORT=5432
      - DB_DATABASE=db
      - DB_USER=user
      - DB_PASSWORD=password
      - DB_SCHEMA=public
      - DB_TABLE_PREFIX=
      - CP_TRIGGER=admin
      - PRIMARY_SITE_URL=http://127.0.0.1:3000
    ports:
      - 3000:3000
```
